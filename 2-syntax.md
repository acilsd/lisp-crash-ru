# Синтаксис

## Литералы

![Атом](http://upload.wikimedia.org/wikipedia/commons/thumb/e/e2/Stylised_Lithium_Atom.png/200px-Stylised_Lithium_Atom.png)

- Числа: `1`, `0.1`, `1e-1`, `1/10`, `#c(0 -1)`
- Буквы: `#\a, `#\ї`, `#\Space`
- Строки: `"hello world"`
- Массивы: `#(1 2 3)`, `#2A((1 0) (0 1))`
- Символы: `foo`, `foo:bar`, `foo::bar`, `*standard-output*`, `:bar` (ключи)
- ...

`#` — спецсимвол, который обычно вводит особый синтаксис для записи литералов. Еще примеры: `#p"/home/user/hello.lisp"` — литерал пути к файлу.


## Список как способ представления кода

![Cons cell](http://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Cons-cells.svg/350px-Cons-cells.svg.png)

    (голова . хвост) - т.н. конс-ячейка

    (print "hello world" *standard-output*) => голова: print, хвост: ("hello world" *standard-output*)

	(1 2) => голова: 1, хвост: (2)

    (1 . 2) => голова: 1, хвост: 2

Круглые скобочки и пробел — единственные разделители. (Не считая точки, которая не нужна).

    (print "hello world" *standard-output*)
    \  |        |           |             |
     \-+--\     |           |   /---------/
       |  |     |           |   |
       v  v     v           v   v
     print("hello world", STDOUT);
                        x        x
 
    x         x
    (+   2   2)
      \ /    |
       x     |
      / \    |
     v   v   v
     2   +   2
 
    x                   x
    (<   a  b          c)
      \ /   |          |
       x    |          |
      / \   |          |
     v   v  v          v
     a   >  b && b  <  c
              xx x  x

Вложенные списки — это деревья кода (т.н. абстрактные синтаксические деревья — **AST**) — таким образом код представляется для компилятора любого ЯП:

    (print (+ 2 2))
     ^      ^ ^ ^
     |      | | |
     |      | листья
     |      корень поддерева
     корень дерева
 
     print
       |
       |
      / \
     /   \
    2     2

Исполняемый код:

	CL-USER> (print "hello world" *standard-output*)
    hello world
    "hello world"
    CL-USER> '(print "hello world" *standard-output*)
    (PRINT "hello world" *STANDARD-OUTPUT*)

`(...)` — код, `'(...)` — литерал. **Код — это данные, данные — это код.**


## Имена

![Символы](img/symbols.png)

Имена в Lisp'е обозначаются символами. В отличие от большинства ЯП (в которых символы доступны только компилятору, а программа может манипулировать ими только в определнных синтаксических рамках), символы в Lisp'е — это **первоклассный объект**, доступный во время выполнения программы.

Символ — это интернированная строка и набор свойств.

**Символические вычисления**.

Common Lisp относится к т.н. `Lisp-2` семейству, в котором символы могут одновременно обозначать объекты в разных пространствах имен: переменных, функций, типов, классов и т.д. Т.е. функция `print` может одновременно быть и переменной `print` и типом `print`.

Символы существуют не сами по себе, а относятся к **пакетам**. Запись `common-lisp:print` — это полное имя публичного символа `print` в пакете `common-lisp`. Также в пакете могут быть неэкспортируемые (приватные) символы, которые доступны так: `common-lisp::print`. А еще есть символы в пакете `keyword` — они доступны из любого пакета по сокращенному имени `:key`.

Lisp reader читает всё в каком-то пакете, который является пакетом по-умолчанию на данный момент. Например, следующий код выполняется в пакете `CL-USER`, поэтому символ `foo`, который мы видим впервые, создается в пакете `cl-user` (т.е. `cl-user:foo`).

    CL-USER> (defvar foo 1)


## Задание

1. Перечислите, какие еще литералы в Lisp'е вам встречались или найти какие-то литералы.
2. Почему в этой форме требуется использовать оператор `progn`? Можно ли обойтись без него и как?

     (if (some-condition-holds)
         (progn (do-this)
                (do-that))
         (dont-do-it))

3. Отобразите в Lisp нотации следующюю комбинацию логических условий:

    isShort(sentence) && (isEnglish(sentence) || (isLowerCase(sentence.start()) && !matches(sentence)))

4. Отобразите в Lisp нотации следующее дерево синтаксического разбора предложения:

                    TOP
                     |
                     S
          /          |            \
         NP          VP            .
         |        /     \          |
         DT      VB      NP       "."
         |       |      /  \
        "This"  "is"    DT   NN
                        |     |
                       "a"  "test"

